<!DOCTYPE html>
<html>
<head>
	<title>Istana Buah</title>
	<link rel="icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAW5QTFRFAAAA////0tvZx9LPzNbT+Pn5ytTR/////f7+6+/u3OPh/f7+z9nWk6iiZ4V99vj3qbq1q7y39/n4////ssG9q7u3////zdfUz9jW////kaeh6+/uZoR82+Lhkaagrr65qru29/j4VnduU3VsMltPMFlNL1hNMFhNMlpPU3VrYoF4NFxRMVpOM1tQTnBnmq2oucbDd5GKPGJXQGZbZYN7zdfUr7+7TnFnTG9m1d7b////+fr6y9XSbYqCVHZsRGlf3uXjma2oYH929vj33+Xj8/X119/dQWZcQmddo7Ww9/j4/v7+gJmSrr654ObkQ2heVXZt3+XkpbeyYYB4d5KKobOu4OblWHlw8PPydpGJobSvwMzJR2thfpeQ09zacY2ForSv4eflQGVb1Nza/Pz8zNbTc46HT3Jol6um4ujmuMbC8vX08/b1k6iiNV1SRmpgkqeit8XCZoR7NVxSZ4V8q7u3g5yVRWpgL1hMTG9lP4p8BAAAACJ0Uk5TAAAAAAAAAAc1cJIrnef9Q9fXQyzW1gadnTXmb/yR5tbXQ85/LV8AAAABYktHRAH/Ai3eAAAACXBIWXMAAArwAAAK8AFCrDSYAAAA7UlEQVQY02NgYGBkZOfg5OLi5GBnZGQAAkYmbh5ePiUlPl4ebiagCCMzv4Cyiqqauoa6pqAQCyMDq7CIlraOrp6+gaGRsagwK4OYuImpmbmFpZWVtY2tnYQYg6SUvYOVo5OzlYurlZu7lCSDtIyHi5Wnlpe3j6+Vn7+MNINsgH+gVVCws3dIqFWYfYAsSACoIjzCOzIKIgDU4mAVHRMbF59glWgP1CIplZRslZKalp6UYZUZIyfJICZhF5yVbZWTm5dfUFgkLgZ0mGhScUlpWbmuRkWlPNBhjCxCgsqq6hXqqhrKCopsjJieQ/c+ADujLMv2KQryAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTAyLTAxVDAxOjI0OjE2KzAwOjAw9SsECAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wMi0wMVQwMToyNDoxNiswMDowMIR2vLQAAABGdEVYdHNvZnR3YXJlAEltYWdlTWFnaWNrIDYuNy44LTkgMjAxNC0wNS0xMiBRMTYgaHR0cDovL3d3dy5pbWFnZW1hZ2ljay5vcmfchu0AAAAAGHRFWHRUaHVtYjo6RG9jdW1lbnQ6OlBhZ2VzADGn/7svAAAAGHRFWHRUaHVtYjo6SW1hZ2U6OmhlaWdodAAxOTIPAHKFAAAAF3RFWHRUaHVtYjo6SW1hZ2U6OldpZHRoADE5MtOsIQgAAAAZdEVYdFRodW1iOjpNaW1ldHlwZQBpbWFnZS9wbmc/slZOAAAAF3RFWHRUaHVtYjo6TVRpbWUAMTU4MDUyMDI1NlX6H94AAAAPdEVYdFRodW1iOjpTaXplADBCQpSiPuwAAABWdEVYdFRodW1iOjpVUkkAZmlsZTovLy9tbnRsb2cvZmF2aWNvbnMvMjAyMC0wMi0wMS9kNzBlMmI2ZGFkYzZiYTlhZWNlY2ViNWU5YjEzNTBkMC5pY28ucG5ncxlsbQAAAABJRU5ErkJggg==" sizes="16x16" type="image/png">
	<style>
		body{
			text-align: center;
			align-items: center;
			font-family: sans-serif;
		}

		#title{ cursor: pointer; }

		table{
			border-collapse: collapse;
			margin: auto;
			margin-top: 10px;
		}

		table td, table th{
		  border: 1px solid #ddd;
		  padding: 0px 8px;
		  text-align: left;
		}

		table th{
			text-align: left;
			background-color: #4CAF50;
			color: white;
			padding-top: "12px"padding-bottom: "12px"text-align: "left"background-color: "#4CAF50" color: "white"
		}
		table tr:hover{ background: rgba(0,0,0,0.1); }
		table tr:nth-child(even){ background: #ddd; }
		.tleft{ text-align: left; }
		.tright{ text-align: right;}
		.tcenter{text-align: center;}

		.form table{
			margin: auto;
			margin-top: 20px;
			text-align: left;
		}
		.form tr, .form tr td{
			background: #fff;
			border: 0px;
		}
	</style>
</head>
<body>
	<h1 id="title">Toko Istana Buah</h1>
	<h3>Dibuat Oleh: Isep Lutpi Nur</h3>
	<a href="#" id="m_master_buah">Master Buah</a> |
	<a href="#" id="m_pengadaan">Pengadaan</a> |
	<a href="#" id="m_penjualan">Penjualan</a> |
	<a href="#" id="m_stok_buah">Stok Buah</a>
	<div id="d_master_buah" style="display: none;">
			<table class="form">
				<tr>
					<td colspan="3" style="text-align: center;">
						Tambah Data Master Buah
					</td>
				</tr>
				<tr>
						<form>
						<td><label for="nama_buah_mb">Nama buah</label></td>
					<td style="width: 1px;">:</td>
					<td>
						<input type="text"id="nama_buah_mb" maxlength="25">
					</td>
				</tr>
				<tr>
					<td><label for="harga_beli_mb">Harga Beli</label></td>
					<td style="width: 1px;">:</td>
					<td>
						<input type="number"id="harga_beli_mb" maxlength="25">
					</td>
				</tr>
				<tr>
					<td><label for="harga_jual_mb">Harga Jual</label></td>
					<td style="width: 1px;">:</td>
					<td>
						<input type="number"id="harga_jual_mb" maxlength="6">
						</form>
					</td>
				</tr>
				<tr>
					<td></td>
					<td style="width: 1px;"></td>
					<td><button id="simpan_mb">Simpan</button></td>
				</tr>
			</table>
		<br><span style="color: #f00;" id="pemberitahuan_mb"></span><br>
		<div id="d_master_buah_main"></div>
	</div>
	<div id="d_pengadaan" style="display: none;">
			<table class="form">
				<tr>
					<td colspan="3" style="text-align: center;">
						Tambah Data Pengadaan Buah
					</td>
				</tr>
				<tr>
					<td>Nama Buah</td>
					<td style="width: 1px;">:</td>
					<td>
						<form>
						<select id="nama_buah_no_pd">
							<option value=""></option>
						</select>
					</td>
				</tr>
				<tr>
					<td><label for="nama_suplier">Nama Suplier</label></td>
					<td style="width: 1px;">:</td>
					<td>
						<input type="text"id="nama_pd" maxlength="25">
					</td>
				</tr>
				<tr>
					<td><label for="jumlah">Jumlah</label></td>
					<td style="width: 1px;">:</td>
					<td>
						<input type="number"id="jumlah_pd" maxlength="6">
						</form>
					</td>
				</tr>
				<tr>
					<td></td>
					<td style="width: 1px;"></td>
					<td><button id="simpan_pd">Simpan</button></td>
				</tr>
			</table>
		<br><span style="color: #f00;" id="pemberitahuan_pd"></span><br>
		<div id="d_pengadaan_main"></div>
	</div>
	<div id="d_penjualan" style="display: none;">
			<table class="form">
				<tr>
					<td colspan="3" style="text-align: center;">
						Tambah Data Penjualan Buah
					</td>
				</tr>
				<tr>
					<td>Nama Buah</td>
					<td style="width: 1px;">:</td>
					<td>
						<form>
						<select id="nama_buah_no_pj">
							<option value=""></option>
						</select>
					</td>
				</tr>
				<tr>
					<td><label for="nama_suplier">Nama Pembeli</label></td>
					<td style="width: 1px;">:</td>
					<td>
						<input type="text"id="nama_pj" maxlength="25">
					</td>
				</tr>
				<tr>
					<td><label for="jumlah">Jumlah</label></td>
					<td style="width: 1px;">:</td>
					<td>
						<input type="number"id="jumlah_pj" maxlength="6">
						</form>
					</td>
				</tr>
				<tr>
					<td></td>
					<td style="width: 1px;"></td>
					<td><button id="simpan_pj">Simpan</button></td>
				</tr>
			</table>
		<br><span style="color: #f00;" id="pemberitahuan_pj"></span><br>
		<div id="d_penjualan_main"></div>
	</div>
	<div id="d_stok_buah" style="display: none;"></div>
</body>
</html>

<script>
// title main
	const title = getById("title");

// variable data
	// master buah
		var mb_nama = [
			"Jeruk", "Mangga", "Melon",
			"Semangka", "Durian"

		];

		var mb_harga_beli = [
			5000, 8000, 15000,
			13000, 80000
		];
		var mb_harga_jual = [
			6000, 9000, 17000,
			15000, 100000
		];
	// pengadaan
		var pd_nama = [
			"sarana buah", "dunia buah",
			"sarana buah"
		];

		var pd_buah = [
			0, 2, 3
		];

		var pd_qty = [
			80, 20, 30
	// pembelian
		]
		var pj_nama = [
			"Fransiska", "Yudi",
			"Nia"
		];

		var pj_buah = [
			0, 3, 0
		];

		var pj_qty = [
			20, 5, 30
		]

// fungsi untuk mengelola page menu
	function _master_buahFun(x){
		var no = 0;
		var html1 = "<table><thead><tr><th>NO</th><th>Nama</th><th>Harga jual</th><th>Harga Beli</th></tr></thead><tbody>";
		for (var i = mb_nama.length - 1; i >= 0 ; i--) {
			html1 +=
			"<tr><td>" + ++no
			+ "</td><td>" +  mb_nama[i]
			+ "</td><td class='tright'>" + mb_harga_jual[i]
			+ "</td><td class='tright'>" + mb_harga_beli[i]
			+ "</td></tr>";
		}
		html1 += "</tbody></table>";
		htmlById("d" + x + "_main", html1);
	}

	function _pengadaanFun(x){
		var no = 0;
		var html1 = "<table><thead><tr><th>NO</th><th>Nama Suplier</th><th>Buah</th><th>Harga Satuan</th><th>Qty</th><th>Harga jual</th></tr></thead><tbody>";
		for (var i = pd_nama.length - 1; i >= 0; i--) {
			html1 +=
			"<tr><td>" + ++no
			+ "</td><td>" + pd_nama[i]
			+ "</td><td>" + mb_nama[pd_buah[i]]
			+ "</td><td class='tright'>" +  mb_harga_jual[pd_buah[i]] 
			+ "</td><td class='tright'>" + pd_qty[i]
			+ "</td><td class='tright'>" + (pd_qty[i] * mb_harga_jual[pd_buah[i]])
			+ "</td></tr>";
		}
		html1 += "</tbody></table>";
		htmlById("d" + x + "_main", html1);
	}

	function _penjualanFun(x){
		var no = 0;
		var html1 = "<table><thead><tr><th>NO</th><th>Nama Suplier</th><th>Buah</th><th>Harga Satuan</th><th>Qty</th><th>Harga jual</th></tr></thead><tbody>";
		for (var i = pj_nama.length - 1; i >= 0 ; i--) {
			html1 +=
			"<tr><td>" + ++no
			+ "</td><td>" + pj_nama[i]
			+ "</td><td>" + mb_nama[pj_buah[i]]
			+ "</td><td class='tright'>" +  mb_harga_jual[pj_buah[i]] 
			+ "</td><td class='tright'>" + pj_qty[i]
			+ "</td><td class='tright'>" + (pj_qty[i] * mb_harga_jual[pj_buah[i]])
			+ "</td></tr>";
		}
		html1 += "</tbody></table>";
		htmlById("d" + x + "_main", html1);
	}

	function _stok_buahFun(x){
		var no = 0;
		var html1 = "<br><br><table><thead><tr><th>NO</th><th>Nama Buah</th><th>Pengadaan</th><th>Penjualan</th></th><th>Stok Akhir</th></tr></thead><tbody>";
		for (var i = mb_nama.length - 1; i >= 0; i--) {
			html1 +=
			"<tr><td>" + ++no
			+ "</td><td>" +  mb_nama[i]
			+ "</td><td class='tright'>" + zeroHide(hitung_stok(i, "pengadaan"))
			+ "</td><td class='tright'>" + zeroHide(hitung_stok(i))
			+ "</td><td class='tright'>" + zeroHide(cekStok(i))
			+ "</td></tr>";
		}
		html1 += "</tbody></table>";
		htmlById("d" + x, html1);
	}

	function hitung_stok(x = 0, y = ""){
		var total = 0;
		if (y == "pengadaan") {
			for(var i = 0; i < pd_nama.length; i++){
				if (pd_buah[i] == x) { total = total + pd_qty[i]; }
			}
		}
		else {
			for(var i = 0; i < pj_nama.length; i++){
				if (pj_buah[i] == x) { total = total + pj_qty[i]; }
			}
		}
		return total;
	}

	function zeroHide(x = 0){
		if (x == 0) return "";
		else return x;
	}

// variable menu
	const m_master_buah = getById("m_master_buah");
	const m_pengadaan = getById("m_pengadaan");
	const m_penjualan = getById("m_penjualan");
	const m_stok_buah = getById("m_stok_buah");
	const simpan_pd = getById("simpan_pd");
	const simpan_pj = getById("simpan_pj");

// variable display
	var d_master_buah = getById("d_master_buah");
	var d_pengadaan = getById("d_pengadaan");
	var d_penjualan = getById("d_penjualan");
	var d_stok_buah = getById("d_stok_buah");

// variable untuk mengatur dispaly
	var con_menu = [
	"_master_buah",
	"_pengadaan",
	"_penjualan",
	"_stok_buah"
	];

// click
	m_master_buah.addEventListener("click", function(){ mFun("_master_buah"); alertMb();});
	m_pengadaan.addEventListener("click", function(){ mFun("_pengadaan");});
	m_penjualan.addEventListener("click", function(){ mFun("_penjualan"); validasiPj();});
	m_stok_buah.addEventListener("click", function(){ mFun("_stok_buah");});
	title.addEventListener("click", function(){ visibility();});
	simpan_pd.addEventListener("click", function(){ simpan_Fun();});
	simpan_pj.addEventListener("click", function(){ simpan_Fun("pj");});

// controllers
	function visibility(x = ""){
		for (var i = con_menu.length - 1; i >= 0; i--) {
			if(con_menu[i] != x) {
				getById("d" + con_menu[i]).setAttribute('style', 'display: none;');
				getById("m" + con_menu[i]).setAttribute('href', '#');
			}
			else {
				getById("d" + con_menu[i]).removeAttribute('style'); 
				getById("m" + con_menu[i]).removeAttribute('href');
			}
		}
	}

	function mFun(x){
		visibility(x);
		     if (x == "_master_buah") _master_buahFun(x);
		else if (x == "_pengadaan") { _pengadaanFun(x); refreshBuah("pd");}
		else if (x == "_penjualan") { _penjualanFun(x); refreshBuah("pj");}
		else if (x == "_stok_buah") _stok_buahFun(x);
		alertFun();
	}

	function refreshBuah(x = false){
		if (x != false) {
			var html1 = "";
			for(var i = 0; i < mb_nama.length; i++){
				html1 += "<option value=\"" + i + "\">" + mb_nama[i] + "</option>";
			}
			htmlById("nama_buah_no_" + x, html1);
		}
	}

// javascript query builder
	function getById(x = false){
		if (x !=false) {
			return document.getElementById(x);
		} else return null;
	}

	function htmlById(x = false, y = false){
		if (x !=false && y != false) {
			return document.getElementById(x).innerHTML = y;
		} else return null;
	}

	function valById(x = false, y = false){
		if (x !=false && y != false) {
			return document.getElementById(x).value = y;
		} else return null;
	}

// simpan data
	function simpan_Fun(x = "pd"){
		var buah = getById("nama_buah_no_" + x).value;
		var nama = getById("nama_" + x).value;
		var jumlah = getById("jumlah_" + x).value;
		if (validasiInputKosong("nama_" + x) && validasiInputKosong("jumlah_" + x)){
			if (x == "pd") {
				pd_nama.push(nama);
				pd_buah.push(buah);
				pd_qty.push(Number(jumlah));
			} else {
				pj_nama.push(nama);
				pj_buah.push(buah);
				pj_qty.push(Number(jumlah));
			}
			getById("nama_buah_no_" + x).value = 0;
			getById("nama_" + x).value = "";
			getById("jumlah_" + x).value = "";
			alertFun(x, "#00f", "Berhasil disimpan..!");
			//reload
			if (x == "pd") _pengadaanFun("_pengadaan");
			else _penjualanFun("_penjualan");
		} else {
			alertFun(x, "#f00", "Tidak boleh ada kolom yang kosong atau nol")
		}
	}

	function alertFun(x = true, y = "#f00", z = ""){
		if (x) {
			getById("pemberitahuan_pd").style.color = y;
			getById("pemberitahuan_pd").innerHTML = z;
			getById("pemberitahuan_pj").style.color = y;
			getById("pemberitahuan_pj").innerHTML = z;
		} else {
			getById("pemberitahuan_" + x).style.color = y;
			getById("pemberitahuan_" + x).innerHTML = z;
		}
	}

// validasi simpan penjualan data
	var id_buah = getById("nama_buah_no_pj");
	id_buah.addEventListener("click", function(){ validasiPj() });
	getById("nama_pj").addEventListener("keyup", function(){ validasiPj() });
	getById("jumlah_pj").addEventListener("keyup", function(){ validasiPj() });

	function validasiPj(){
		var inputJml = getById("jumlah_pj").value;
		var cek = cekStok(id_buah.value) - inputJml;
		if (cek < 0){
			alertFun("pj", "#f00", "Stok Kurang Mohon Kurangi Jumlah Pembelian<br>Stok <b>" +
				mb_nama[id_buah.value] + "</b> Yang tersedia adalah <b>" + cekStok(id_buah.value) + "<b>");
			simpanButton("pj");
		} else {
				alertFun();
				simpanButton("pj", true);
		}
	}



	function cekStok(x){
		return hitung_stok(x, "pengadaan") - hitung_stok(x);
	}

	function validasiInputKosong(x){
		if(
			getById(x).value == "" || 
			getById(x).value == " " || 
			getById(x).value == "0" || 
			getById(x).value <= 0
				) {
			return false;
		} else return true;
	}

	function simpanButton(y = "pd", x = false){
		if (x) getById("simpan_" + y).removeAttribute('disabled');
		else getById("simpan_" + y).setAttribute('disabled', '');
	}

// Simpan data tambah data master buah
	// variable
		var nama_buah_mb = getById("nama_buah_mb");
		var harga_beli_mb = getById("harga_beli_mb");
		var harga_jual_mb = getById("harga_jual_mb");
		var simpan_mb = getById("simpan_mb");

	// action
	nama_buah_mb.addEventListener("keyup", function(){ validasiMb(); });
	harga_beli_mb.addEventListener("keyup", function(){ validasiMb(); });
	harga_jual_mb.addEventListener("keyup", function(){ validasiMb(); });
	simpan_mb.addEventListener("click", function(){ simpanMb(); });

	function simpanMb(){
		if (validasiMb()) {
			mb_nama.push(nama_buah_mb.value);
			mb_harga_beli.push(Number(harga_beli_mb.value));
			mb_harga_jual.push(Number(harga_jual_mb.value));
			resetInMb();
			_master_buahFun("_master_buah");
			alertMb("Data berhasil ditambahkan..!", "#00f");

		}
	}

	function validasiMb(){
		simpanButton("mb");
		if (validasiInputKosong("nama_buah_mb") || validasiInputKosong("harga_beli_mb") || validasiInputKosong("harga_jual_mb")) {
			if (cekBuah()) {
				if (cekHargaBuah()) {
					simpanButton("mb", true);
					alertMb();
					return true;
				} else {
					simpanButton("mb");
					alertMb("Harga jual harus lebih tinggi dari harga beli..!");
				}
			} else {
				simpanButton("mb");
				alertMb("Nama Buah sudah ada..!");
			}
		} else {
			simpanButton("mb");
			alertMb("Kolom harus di isi semua..!");
		}
	}

	function cekBuah(){
		var x = nama_buah_mb.value;
		var cek = 0;
		for(var i = 0; i < mb_nama.length; i++){
			if (mb_nama[i].toLowerCase() == x.toLowerCase()) cek++;
		}
		if (cek > 0) return false;
		else return true;
	}

	function cekHargaBuah(){
		var x = Number(harga_jual_mb.value);
		var y = Number(harga_beli_mb.value);
		if (x > 0 && y > 0) {
			if (x > y) return true;
			else return false;
		} else return false;
	}

	function resetInMb(){
		nama_buah_mb.value = "";
		harga_beli_mb.value = "";
		harga_jual_mb.value = "";
	}

	function alertMb(x = "", y = "#f00") {
		getById("pemberitahuan_mb").style.color = y;
		getById("pemberitahuan_mb").innerHTML = x;
	}
// 
</script>
